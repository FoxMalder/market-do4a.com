<template>
  <header class="h-navbar-collapse">
    <div class="change-city-collapse collapse" data-parent=".h-navbar-collapse">
      <div class="container">
        <div class="change-city">
          <div class="change-city__header">
            <span class="change-city__title">Города в которых есть <span class="font-weight-normal">market</span>do<span class="selected">4</span>a</span>
            <button class="change-city__btn-close btn" data-toggle="collapse" data-target=".change-city-collapse"></button>
          </div>
          <ul class="change-city__list">
            <!--            <template v-for="(list, char) in chars">-->
            <!--              <li class="change-city__item"-->
            <!--                  v-for="(cityId, index) in list"-->
            <!--                  :data-letter="index === 0 ? char : ''">-->
            <!--                <a class="change-city__link" href="#"-->
            <!--                   @click.prevent="setCity(cityId)"-->
            <!--                >{{ getCityById(cityId).name }}</a>-->
            <!--              </li>-->
            <!--            </template>-->
            <template v-for="item in chars">
              <li class="change-city__item"
                  v-for="(city, i) in item.cityList"
                  :data-letter="i === 0 ? item.char : ''">
                <a class="change-city__link" :href="getUrl(city.subDomain)"
                   @click.prevent="setCity(city)"
                >{{ city.name }}</a>
              </li>
            </template>
            <!--              <li class="change-city__item"-->
            <!--                  v-for="(city, i) in cityList">-->
            <!--                <a class="change-city__link" href="#"-->
            <!--                   @click.prevent="setCity(city)"-->
            <!--                >{{ city.name }}</a>-->
            <!--              </li>-->
          </ul>
          <div class="change-city__footer">
            <a class="change-post" href="#" @click.prevent="setPost">
              <svg class="change-post__icon" viewBox="0 0 105 77" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M62.2393 1.42896H98.6675V12.7343H62.2393V1.42896Z" fill="#E84434"/>
                <path d="M56.7567 62.9773H102.162V73.3827H56.7567V62.9773Z" fill="#E84434"/>
                <path d="M56.7567 22.3016L65.2702 18.5178H79.4594H93.6486L102.162 22.3016V32.707H56.7567V22.3016Z" fill="#E84434"/>
                <path d="M56.7567 28.5511H65.2702H79.4594H93.6486H102.162V61.6593H56.7567V28.5511Z" fill="#292929"/>
                <path d="M61.3872 17.8292C61.3599 17.8439 61.343 17.8595 61.3159 17.8743C61.1915 17.942 61.0725 18.0106 60.9505 18.0819C60.8968 18.1135 60.8465 18.1466 60.7932 18.1788C60.6993 18.2353 60.6065 18.2918 60.5141 18.3503C60.4544 18.3883 60.3964 18.4279 60.3375 18.4668C60.2532 18.522 60.1693 18.5772 60.0865 18.634C60.0248 18.6764 59.9646 18.7201 59.9038 18.7634C59.8251 18.8194 59.7466 18.8752 59.6694 18.9325C59.6079 18.9783 59.5474 19.0251 59.4867 19.0718C59.4119 19.1292 59.3373 19.1868 59.2636 19.2454C59.2031 19.2938 59.1437 19.343 59.084 19.3923C59.0121 19.4519 58.9405 19.5117 58.8697 19.5726C58.8108 19.6234 58.7527 19.6748 58.6946 19.7266C58.6252 19.7883 58.5565 19.8507 58.4885 19.9136C58.4312 19.9661 58.3744 20.0196 58.318 20.074C58.2514 20.1378 58.1855 20.2022 58.1201 20.2673C58.0645 20.3225 58.0094 20.378 57.9547 20.4339C57.8905 20.5002 57.8269 20.5671 57.7639 20.6346C57.7107 20.6912 57.6578 20.7479 57.6058 20.8055C57.5432 20.8746 57.4817 20.9446 57.4205 21.015C57.3701 21.0727 57.3196 21.1303 57.2701 21.1885C57.209 21.261 57.1492 21.3346 57.0895 21.4083C57.0425 21.4664 56.9948 21.5243 56.9486 21.5831C56.8881 21.6601 56.8295 21.7385 56.7706 21.8166C56.7274 21.8741 56.6836 21.9309 56.6412 21.9888C56.5797 22.0732 56.5202 22.159 56.4606 22.2447C56.4232 22.2982 56.385 22.3509 56.3482 22.405C56.2766 22.5105 56.2076 22.6178 56.1396 22.7254C56.1169 22.7608 56.0932 22.7955 56.0709 22.831C55.9812 22.974 55.894 23.1187 55.8094 23.2649C55.7829 23.3108 55.758 23.3576 55.732 23.4037C55.6745 23.5055 55.6171 23.6071 55.5622 23.7103C55.5301 23.7696 55.5009 23.83 55.47 23.8898C55.423 23.981 55.3758 24.072 55.3307 24.1642C55.2986 24.2293 55.2687 24.2953 55.2381 24.3609C55.1965 24.4493 55.1549 24.5375 55.1151 24.6266C55.0846 24.6953 55.0557 24.7645 55.0262 24.8336C54.9888 24.9212 54.9515 25.0088 54.9159 25.0969C54.8873 25.1678 54.8602 25.2389 54.8328 25.3104C54.7989 25.3985 54.7653 25.4865 54.7332 25.5752C54.7069 25.6477 54.6817 25.7206 54.6567 25.7935C54.6262 25.8822 54.5964 25.971 54.5674 26.06C54.5437 26.1336 54.5205 26.2079 54.4979 26.2828C54.4707 26.3721 54.4444 26.4618 54.4189 26.5518C54.3975 26.6269 54.3769 26.702 54.3571 26.7773C54.3331 26.8681 54.3099 26.9592 54.2878 27.0505C54.2694 27.1259 54.2515 27.2016 54.234 27.2774C54.2132 27.3699 54.1937 27.4626 54.1746 27.5556C54.1586 27.6311 54.1435 27.7066 54.1292 27.7824C54.1114 27.8771 54.0952 27.9726 54.0793 28.068C54.0669 28.1426 54.0539 28.217 54.0427 28.2919C54.0279 28.39 54.0152 28.4888 54.0025 28.5876C53.9932 28.6605 53.983 28.733 53.9748 28.8062C53.9631 28.9096 53.9541 29.0132 53.9446 29.1171C53.9383 29.1862 53.931 29.2551 53.9258 29.3244C53.9172 29.4394 53.9114 29.555 53.9056 29.6715C53.9027 29.7299 53.9326 29.7881 53.9303 29.8465C53.9237 30.0208 53.9544 30.1956 53.9544 30.3709V68.3364C53.9482 70.4183 54.7824 72.4176 56.2741 73.8957C57.7658 75.3738 59.7931 76.2099 61.9113 76.2206H97.0466C99.1648 76.2089 101.192 75.3717 102.683 73.8927C104.174 72.4138 105.007 70.4138 104.999 68.3318V30.3711C105.024 27.5373 104.195 24.7598 102.616 22.3886C101.263 20.3323 99.3685 18.6746 97.1339 17.5913V14.319C97.5547 14.3037 97.954 14.1326 98.2517 13.84C98.5495 13.5473 98.7236 13.1548 98.7391 12.7412V3.32836C98.7272 2.4869 98.3786 1.6839 97.7687 1.09328C97.1588 0.502668 96.3367 0.171984 95.4805 0.172853H63.4726C62.6165 0.171984 61.7944 0.502668 61.1845 1.09328C60.5746 1.6839 60.2259 2.4869 60.2141 3.32836V12.7417C60.2296 13.1553 60.4037 13.5478 60.7015 13.8404C60.9992 14.133 61.3985 14.3042 61.8193 14.3195V17.5984C61.6588 17.6724 61.5358 17.749 61.3872 17.8292ZM93.9235 14.3726V17.0406H65.0297V14.3726H93.9235ZM57.1642 33.9368H101.789V60.6008H57.1642V33.9368ZM97.0419 73.0651H61.9156C61.2873 73.0612 60.666 72.9357 60.0871 72.6957C59.5082 72.4557 58.9831 72.1059 58.5419 71.6663C58.1006 71.2267 57.7518 70.706 57.5154 70.1338C57.279 69.5617 57.1597 68.9493 57.1642 68.3318V63.7563H101.789V68.3272C101.794 68.9448 101.675 69.5573 101.439 70.1296C101.204 70.702 100.855 71.2231 100.414 71.6631C99.9736 72.1031 99.4488 72.4534 98.8701 72.694C98.2914 72.9345 97.6702 73.0606 97.0419 73.0651ZM101.789 30.3711V30.7813H57.1642V30.3711C57.1642 30.2317 57.1321 30.0927 57.138 29.9541C57.1398 29.9067 57.1264 29.8594 57.129 29.8121C57.1335 29.7212 57.129 29.6303 57.1361 29.5397C57.1404 29.4842 57.1425 29.4293 57.1475 29.3738C57.155 29.2917 57.1597 29.2097 57.1691 29.128C57.1759 29.0691 57.1836 29.0106 57.1913 28.9519C57.2014 28.8744 57.2104 28.7968 57.2221 28.7198C57.2314 28.6592 57.2423 28.5992 57.2526 28.539C57.2653 28.4642 57.2772 28.3892 57.2915 28.3148C57.3032 28.2539 57.3167 28.1936 57.3292 28.1329C57.3444 28.06 57.359 27.9868 57.3759 27.9142C57.3899 27.8531 57.4056 27.7925 57.4207 27.7318C57.4385 27.6603 57.4557 27.5887 57.4748 27.5177C57.4908 27.4568 57.5093 27.3965 57.5266 27.3359C57.5469 27.2659 57.5664 27.1958 57.5879 27.1263C57.6067 27.0655 57.6271 27.0056 57.6469 26.9453C57.6693 26.8767 57.6915 26.8079 57.7152 26.7402C57.7363 26.6801 57.7589 26.6204 57.7809 26.5606C57.8056 26.4934 57.8302 26.426 57.8563 26.3593C57.8796 26.2995 57.9045 26.2403 57.9287 26.181C57.9557 26.1155 57.9825 26.0498 58.0106 25.9847C58.0363 25.9254 58.0634 25.8666 58.0909 25.8077C58.1198 25.7437 58.1486 25.6798 58.1788 25.6163C58.2068 25.5577 58.236 25.4997 58.265 25.4415C58.2962 25.3784 58.3273 25.3163 58.3596 25.2542C58.3896 25.1967 58.4207 25.1399 58.4519 25.0829C58.4853 25.0214 58.5186 24.96 58.5532 24.8991C58.5853 24.8426 58.6185 24.7869 58.6514 24.7311C58.6869 24.671 58.7225 24.6112 58.7589 24.5518C58.7933 24.4963 58.8284 24.4414 58.8636 24.3865C58.901 24.3281 58.9386 24.2697 58.9771 24.2129C59.0135 24.1585 59.0506 24.1047 59.0879 24.0511C59.1272 23.9943 59.1667 23.9376 59.2071 23.8814C59.2455 23.8283 59.2847 23.7756 59.324 23.7237C59.3653 23.6684 59.407 23.6135 59.449 23.559C59.4893 23.5072 59.5302 23.4559 59.5713 23.4048C59.6147 23.3512 59.6583 23.2978 59.7023 23.2448C59.7445 23.1945 59.7873 23.1446 59.8307 23.0949C59.876 23.0429 59.9213 22.9911 59.9673 22.94C60.0134 22.8889 60.056 22.8427 60.1009 22.7944C60.1458 22.7461 60.1951 22.6942 60.243 22.6446C60.2908 22.5951 60.3349 22.55 60.3817 22.5039C60.4284 22.4578 60.4796 22.4072 60.5292 22.3594C60.5788 22.3116 60.6247 22.2683 60.6736 22.2235C60.7226 22.1787 60.7749 22.1306 60.8261 22.0847C60.8773 22.0388 60.9253 21.9968 60.9756 21.9536C61.0258 21.9104 61.0801 21.8646 61.1329 21.8207C61.1857 21.7769 61.2355 21.7363 61.2873 21.6945C61.3392 21.6527 61.3953 21.6093 61.4499 21.5683C61.5045 21.5273 61.5555 21.4875 61.6092 21.4479C61.6628 21.4083 61.7201 21.367 61.7761 21.3271C61.8321 21.2871 61.8853 21.2498 61.9405 21.212C61.9957 21.1743 62.0546 21.1354 62.1121 21.0975C62.1695 21.0596 62.2244 21.0243 62.2809 20.9886C62.3374 20.953 62.3984 20.9159 62.4575 20.8801C62.5166 20.8443 62.5721 20.811 62.6302 20.7775C62.6883 20.7441 62.7509 20.7091 62.8116 20.6754C62.8723 20.6418 62.9291 20.6106 62.9882 20.5791C63.0473 20.5475 63.112 20.5152 63.1744 20.4844C63.2343 20.4542 63.2943 20.4238 63.355 20.3948C63.4157 20.3657 63.482 20.3353 63.5457 20.3063C63.6094 20.2772 63.6683 20.2501 63.7303 20.2231C63.7499 20.2147 63.7696 20.2073 63.789 20.1987H95.136C99.147 21.8818 101.789 25.9327 101.789 30.3711ZM63.4726 3.32836H95.5287V11.2171H63.4726L63.4709 3.32836H63.4726Z" fill="white"/>
                <path d="M11.4634 33.271L39.9381 29.8036L40.2849 32.651L11.8101 36.1185L11.4634 33.271Z" fill="white"/>
                <path d="M21.3929 43.6207L41.3253 41.1935L41.672 44.041L21.7397 46.4682L21.3929 43.6207Z" fill="#E84434"/>
                <path d="M0 57.7845L42.7121 52.5834L43.0589 55.4309L0.346744 60.632L0 57.7845Z" fill="white"/>
              </svg>
              <div class="change-post__title">Отправлять почтой<br> с центрального склада</div>
              <div class="change-post__note">Срок от 5 дней</div>
            </a>
            <div class="change-city__note">
              <b>Не нашли магазина в вашем городе?</b> Отправим с центрального склада почтой или транспортной компанией.
              Доставка от 250 ₽. Отправка на следующий рабочий день.
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="change-store-collapse collapse" data-parent=".h-navbar-collapse">
      <div class="container">
        <div class="change-city">
          <div class="change-city__header">
            <span class="change-city__second-title">Выберите магазин<br> в <span class="selected">{{ currentCity ? currentCity.name5 : '' }}</span></span>
            <button class="change-city__btn-close btn" data-toggle="collapse" data-target=".change-store-collapse"></button>
          </div>
          <ul class="change-store-list">
            <li class="change-store-list__item"
                v-for="store in storeList"
                :key="store.id">
              <a class="change-store-item" href="#"
                 :class="{ active: storeId === store.id }"
                 @click.prevent="setStore(store)">
                <div class="change-store-item__name">{{ store.name }}</div>
                <div class="change-store-item__subtitle">{{ store.shortAddress }}</div>
                <div class="change-store-item__note">
                  {{ store.courier ? 'Курьер и самовывоз' : 'Только самовывоз' }}
                </div>
              </a>
            </li>
          </ul>
          <div class="change-city__footer">
            <a class="change-post" href="#" @click.prevent="setPost">
              <svg class="change-post__icon" viewBox="0 0 105 77" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M62.2393 1.42896H98.6675V12.7343H62.2393V1.42896Z" fill="#E84434"/>
                <path d="M56.7567 62.9773H102.162V73.3827H56.7567V62.9773Z" fill="#E84434"/>
                <path d="M56.7567 22.3016L65.2702 18.5178H79.4594H93.6486L102.162 22.3016V32.707H56.7567V22.3016Z" fill="#E84434"/>
                <path d="M56.7567 28.5511H65.2702H79.4594H93.6486H102.162V61.6593H56.7567V28.5511Z" fill="#292929"/>
                <path d="M61.3872 17.8292C61.3599 17.8439 61.343 17.8595 61.3159 17.8743C61.1915 17.942 61.0725 18.0106 60.9505 18.0819C60.8968 18.1135 60.8465 18.1466 60.7932 18.1788C60.6993 18.2353 60.6065 18.2918 60.5141 18.3503C60.4544 18.3883 60.3964 18.4279 60.3375 18.4668C60.2532 18.522 60.1693 18.5772 60.0865 18.634C60.0248 18.6764 59.9646 18.7201 59.9038 18.7634C59.8251 18.8194 59.7466 18.8752 59.6694 18.9325C59.6079 18.9783 59.5474 19.0251 59.4867 19.0718C59.4119 19.1292 59.3373 19.1868 59.2636 19.2454C59.2031 19.2938 59.1437 19.343 59.084 19.3923C59.0121 19.4519 58.9405 19.5117 58.8697 19.5726C58.8108 19.6234 58.7527 19.6748 58.6946 19.7266C58.6252 19.7883 58.5565 19.8507 58.4885 19.9136C58.4312 19.9661 58.3744 20.0196 58.318 20.074C58.2514 20.1378 58.1855 20.2022 58.1201 20.2673C58.0645 20.3225 58.0094 20.378 57.9547 20.4339C57.8905 20.5002 57.8269 20.5671 57.7639 20.6346C57.7107 20.6912 57.6578 20.7479 57.6058 20.8055C57.5432 20.8746 57.4817 20.9446 57.4205 21.015C57.3701 21.0727 57.3196 21.1303 57.2701 21.1885C57.209 21.261 57.1492 21.3346 57.0895 21.4083C57.0425 21.4664 56.9948 21.5243 56.9486 21.5831C56.8881 21.6601 56.8295 21.7385 56.7706 21.8166C56.7274 21.8741 56.6836 21.9309 56.6412 21.9888C56.5797 22.0732 56.5202 22.159 56.4606 22.2447C56.4232 22.2982 56.385 22.3509 56.3482 22.405C56.2766 22.5105 56.2076 22.6178 56.1396 22.7254C56.1169 22.7608 56.0932 22.7955 56.0709 22.831C55.9812 22.974 55.894 23.1187 55.8094 23.2649C55.7829 23.3108 55.758 23.3576 55.732 23.4037C55.6745 23.5055 55.6171 23.6071 55.5622 23.7103C55.5301 23.7696 55.5009 23.83 55.47 23.8898C55.423 23.981 55.3758 24.072 55.3307 24.1642C55.2986 24.2293 55.2687 24.2953 55.2381 24.3609C55.1965 24.4493 55.1549 24.5375 55.1151 24.6266C55.0846 24.6953 55.0557 24.7645 55.0262 24.8336C54.9888 24.9212 54.9515 25.0088 54.9159 25.0969C54.8873 25.1678 54.8602 25.2389 54.8328 25.3104C54.7989 25.3985 54.7653 25.4865 54.7332 25.5752C54.7069 25.6477 54.6817 25.7206 54.6567 25.7935C54.6262 25.8822 54.5964 25.971 54.5674 26.06C54.5437 26.1336 54.5205 26.2079 54.4979 26.2828C54.4707 26.3721 54.4444 26.4618 54.4189 26.5518C54.3975 26.6269 54.3769 26.702 54.3571 26.7773C54.3331 26.8681 54.3099 26.9592 54.2878 27.0505C54.2694 27.1259 54.2515 27.2016 54.234 27.2774C54.2132 27.3699 54.1937 27.4626 54.1746 27.5556C54.1586 27.6311 54.1435 27.7066 54.1292 27.7824C54.1114 27.8771 54.0952 27.9726 54.0793 28.068C54.0669 28.1426 54.0539 28.217 54.0427 28.2919C54.0279 28.39 54.0152 28.4888 54.0025 28.5876C53.9932 28.6605 53.983 28.733 53.9748 28.8062C53.9631 28.9096 53.9541 29.0132 53.9446 29.1171C53.9383 29.1862 53.931 29.2551 53.9258 29.3244C53.9172 29.4394 53.9114 29.555 53.9056 29.6715C53.9027 29.7299 53.9326 29.7881 53.9303 29.8465C53.9237 30.0208 53.9544 30.1956 53.9544 30.3709V68.3364C53.9482 70.4183 54.7824 72.4176 56.2741 73.8957C57.7658 75.3738 59.7931 76.2099 61.9113 76.2206H97.0466C99.1648 76.2089 101.192 75.3717 102.683 73.8927C104.174 72.4138 105.007 70.4138 104.999 68.3318V30.3711C105.024 27.5373 104.195 24.7598 102.616 22.3886C101.263 20.3323 99.3685 18.6746 97.1339 17.5913V14.319C97.5547 14.3037 97.954 14.1326 98.2517 13.84C98.5495 13.5473 98.7236 13.1548 98.7391 12.7412V3.32836C98.7272 2.4869 98.3786 1.6839 97.7687 1.09328C97.1588 0.502668 96.3367 0.171984 95.4805 0.172853H63.4726C62.6165 0.171984 61.7944 0.502668 61.1845 1.09328C60.5746 1.6839 60.2259 2.4869 60.2141 3.32836V12.7417C60.2296 13.1553 60.4037 13.5478 60.7015 13.8404C60.9992 14.133 61.3985 14.3042 61.8193 14.3195V17.5984C61.6588 17.6724 61.5358 17.749 61.3872 17.8292ZM93.9235 14.3726V17.0406H65.0297V14.3726H93.9235ZM57.1642 33.9368H101.789V60.6008H57.1642V33.9368ZM97.0419 73.0651H61.9156C61.2873 73.0612 60.666 72.9357 60.0871 72.6957C59.5082 72.4557 58.9831 72.1059 58.5419 71.6663C58.1006 71.2267 57.7518 70.706 57.5154 70.1338C57.279 69.5617 57.1597 68.9493 57.1642 68.3318V63.7563H101.789V68.3272C101.794 68.9448 101.675 69.5573 101.439 70.1296C101.204 70.702 100.855 71.2231 100.414 71.6631C99.9736 72.1031 99.4488 72.4534 98.8701 72.694C98.2914 72.9345 97.6702 73.0606 97.0419 73.0651ZM101.789 30.3711V30.7813H57.1642V30.3711C57.1642 30.2317 57.1321 30.0927 57.138 29.9541C57.1398 29.9067 57.1264 29.8594 57.129 29.8121C57.1335 29.7212 57.129 29.6303 57.1361 29.5397C57.1404 29.4842 57.1425 29.4293 57.1475 29.3738C57.155 29.2917 57.1597 29.2097 57.1691 29.128C57.1759 29.0691 57.1836 29.0106 57.1913 28.9519C57.2014 28.8744 57.2104 28.7968 57.2221 28.7198C57.2314 28.6592 57.2423 28.5992 57.2526 28.539C57.2653 28.4642 57.2772 28.3892 57.2915 28.3148C57.3032 28.2539 57.3167 28.1936 57.3292 28.1329C57.3444 28.06 57.359 27.9868 57.3759 27.9142C57.3899 27.8531 57.4056 27.7925 57.4207 27.7318C57.4385 27.6603 57.4557 27.5887 57.4748 27.5177C57.4908 27.4568 57.5093 27.3965 57.5266 27.3359C57.5469 27.2659 57.5664 27.1958 57.5879 27.1263C57.6067 27.0655 57.6271 27.0056 57.6469 26.9453C57.6693 26.8767 57.6915 26.8079 57.7152 26.7402C57.7363 26.6801 57.7589 26.6204 57.7809 26.5606C57.8056 26.4934 57.8302 26.426 57.8563 26.3593C57.8796 26.2995 57.9045 26.2403 57.9287 26.181C57.9557 26.1155 57.9825 26.0498 58.0106 25.9847C58.0363 25.9254 58.0634 25.8666 58.0909 25.8077C58.1198 25.7437 58.1486 25.6798 58.1788 25.6163C58.2068 25.5577 58.236 25.4997 58.265 25.4415C58.2962 25.3784 58.3273 25.3163 58.3596 25.2542C58.3896 25.1967 58.4207 25.1399 58.4519 25.0829C58.4853 25.0214 58.5186 24.96 58.5532 24.8991C58.5853 24.8426 58.6185 24.7869 58.6514 24.7311C58.6869 24.671 58.7225 24.6112 58.7589 24.5518C58.7933 24.4963 58.8284 24.4414 58.8636 24.3865C58.901 24.3281 58.9386 24.2697 58.9771 24.2129C59.0135 24.1585 59.0506 24.1047 59.0879 24.0511C59.1272 23.9943 59.1667 23.9376 59.2071 23.8814C59.2455 23.8283 59.2847 23.7756 59.324 23.7237C59.3653 23.6684 59.407 23.6135 59.449 23.559C59.4893 23.5072 59.5302 23.4559 59.5713 23.4048C59.6147 23.3512 59.6583 23.2978 59.7023 23.2448C59.7445 23.1945 59.7873 23.1446 59.8307 23.0949C59.876 23.0429 59.9213 22.9911 59.9673 22.94C60.0134 22.8889 60.056 22.8427 60.1009 22.7944C60.1458 22.7461 60.1951 22.6942 60.243 22.6446C60.2908 22.5951 60.3349 22.55 60.3817 22.5039C60.4284 22.4578 60.4796 22.4072 60.5292 22.3594C60.5788 22.3116 60.6247 22.2683 60.6736 22.2235C60.7226 22.1787 60.7749 22.1306 60.8261 22.0847C60.8773 22.0388 60.9253 21.9968 60.9756 21.9536C61.0258 21.9104 61.0801 21.8646 61.1329 21.8207C61.1857 21.7769 61.2355 21.7363 61.2873 21.6945C61.3392 21.6527 61.3953 21.6093 61.4499 21.5683C61.5045 21.5273 61.5555 21.4875 61.6092 21.4479C61.6628 21.4083 61.7201 21.367 61.7761 21.3271C61.8321 21.2871 61.8853 21.2498 61.9405 21.212C61.9957 21.1743 62.0546 21.1354 62.1121 21.0975C62.1695 21.0596 62.2244 21.0243 62.2809 20.9886C62.3374 20.953 62.3984 20.9159 62.4575 20.8801C62.5166 20.8443 62.5721 20.811 62.6302 20.7775C62.6883 20.7441 62.7509 20.7091 62.8116 20.6754C62.8723 20.6418 62.9291 20.6106 62.9882 20.5791C63.0473 20.5475 63.112 20.5152 63.1744 20.4844C63.2343 20.4542 63.2943 20.4238 63.355 20.3948C63.4157 20.3657 63.482 20.3353 63.5457 20.3063C63.6094 20.2772 63.6683 20.2501 63.7303 20.2231C63.7499 20.2147 63.7696 20.2073 63.789 20.1987H95.136C99.147 21.8818 101.789 25.9327 101.789 30.3711ZM63.4726 3.32836H95.5287V11.2171H63.4726L63.4709 3.32836H63.4726Z" fill="white"/>
                <path d="M11.4634 33.271L39.9381 29.8036L40.2849 32.651L11.8101 36.1185L11.4634 33.271Z" fill="white"/>
                <path d="M21.3929 43.6207L41.3253 41.1935L41.672 44.041L21.7397 46.4682L21.3929 43.6207Z" fill="#E84434"/>
                <path d="M0 57.7845L42.7121 52.5834L43.0589 55.4309L0.346744 60.632L0 57.7845Z" fill="white"/>
              </svg>
              <div class="change-post__title">Отправлять почтой<br> с центрального склада</div>
              <div class="change-post__note">Срок от 5 дней</div>
            </a>
            <div class="change-city__note"><b>Не нашли нужный товар?</b> Отправим с центрального склада почтой или
              транспортной компанией. Доставка от 250 ₽. Отправка на следующий рабочий день.
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>
</template>

<script>
  import { mapGetters, mapState, mapActions } from 'vuex';
  import Utils from '../utils/utils';

  import 'bootstrap/js/dist/util';
  import 'bootstrap/js/dist/collapse';

  export default {
    name: "HeaderCollapse",
    data() {
      return {
        // currentCity: null,
        currentCityId: null,
      }
    },
    computed: {
      ...mapState({
        cityId: 'cityId',
        storeId: 'storeId',
        // cityList: 'cityList',
        // storeList: 'storeList',
      }),
      // ...mapGetters([
      //   'currentCity'
      // ]),
      chars() {
        return Object.keys(global.app.storeManagerData.chars).map(key => ({
          char: key,
          cityList: global.app.storeManagerData.chars[key]
            .map(cityId => this.$store.getters.getCityById(parseInt(cityId, 10))),
        }));
        // let lastChar = '';
        // return this.cityList.map((city, index, array) => {
        //   return {
        //     ...city,
        //     char: city.name[0] !== lastChar ? city.name[0] : '',
        //   }
        // })
      },
      currentCity() {
        return this.currentCityId
          ? this.$store.getters.getCityById(this.currentCityId)
          : this.$store.getters.currentCity;
      },
      storeList() {
        return this.currentCityId
          ? this.$store.getters.getStoreListByCityId(this.currentCityId)
          : this.$store.getters.getStoreListByCityId(this.cityId);
      },
    },
    methods: {
      getUrl(subdomain) {
        if(!subdomain) {
          return '#';
        }
        return `${location.protocol}//${subdomain}.marketdo4a.com${location.pathname}${location.search}`;
      },
      setCity(city) {
        if (city.isMultipleStore) {
          this.currentCityId = city.id;

          this.$nextTick(function() {
            $(document.querySelector('.change-store-collapse')).collapse('show');
          });
        } else {
          // this.sendRequest(city.id, this.$store.getters.getStoreListByCityId(this.currentCityId)[0].id);
          this.setStore(this.$store.getters.getStoreListByCityId(city.id)[0]);
        }
      },
      setStore(store) {
        this.sendRequest(store.cityId, store.id);
      },
      setPost() {
        this.sendRequest(this.$store.state.cityRemoteId, this.$store.state.storeRemoteId);
      },

      sendRequest(cityId, storeId) {
        $.ajax({
          url: document.location.href,
          data: {
            method: 'store.set',
            cityId,
            storeId,
            backUrl: document.location.pathname + document.location.search,
            ajax: 'Y',
            sessid: Utils.sessid(),
          },
          dataType: 'json',
        }).done((response) => {
          if (response.status === 'error') {
            alert(response.error);
            return;
          }

          if (response.redirectUrl) {
            document.location.href = response.redirectUrl;
          } else {
            document.location.reload();
          }
        });
      }
    },
  }
</script>
